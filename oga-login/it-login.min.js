"use strict";$(function(){function e(){o=window.jQuery.noConflict(!0),authForm.formSet()}let o;if(void 0===window.jQuery||"3.0.0"!==window.jQuery.fn.jquery){let o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("src","https://ajax.googleapis.com/ajax/libs/jquery/3.0.0/jquery.min.js"),o.readyState?o.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||e()}:o.onload=e,(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}else o=window.jQuery,authForm.formSet()});let authForm={checkAuth:function(){authForm.showLoader();let e=authForm.getToken();helper.checkNotNull(e)&&authForm.getUserByToken(e,authForm.api_key),authForm.hideLoader()},authenticate:function(){if(authForm.showLoader(),authForm.validate()){let e=authForm.api_key,o=$("input[name=idistributor]").val(),t=$("input[name=ipassword]").val(),r=constants.USER_AUTH_URL.replace("[ak]",e).replace("[ds]",o).replace("[pw]",t);console.log("auth_url: ",r),jQuery.support.cors=!0,$.ajax({url:r,type:"GET",dataType:"text",success:function(o,t,r){console.log("data: ",o),console.log("response: ",t),console.log("request: ",r);let a={SESSION:"aaba56ac-de0c-46b8-8dbc-02ea55f0218c",LOAD:1,ROLES:"distributor"};if(helper.checkNotNull(a)){let o=JSON.stringify(a),t=JSON.parse(o);if(!helper.checkNotNullString(t.SESSION))return authForm.deleteToken(),void(helper.checkNotNull(t.DETAIL)?authForm.showMessage(t.DETAIL):authForm.showMessage("You are not authorized"));authForm.setToken(t.SESSION),authForm.getUserByToken(t.SESSION,e)}authForm.hideLoader()},error:function(e,o,t){console.log("Error: ",e,o,t),helper.checkNotNull(e)&&401===e.status?$(".div-message").text("You are not authorized"):$(".div-message").text("Something went wrong. Unable to fetch data."),authForm.hideLoader()}})}},getUserByToken:function(e,o){console.log("token: ",e);let t=constants.DETAIL_BY_TOKEN_URL.replace("[ak]",o).replace("[di]",authForm.dist_id).replace("[token]",e);console.log("getUserByToken(): ",t),jQuery.support.cors=!0,$.ajax({url:t,type:"GET",dataType:"text",success:function(e,o,t){console.log("data: ",e),console.log("response: ",o),console.log("request: ",t);let r={ROWCOUNT:1,COLUMNS:["NAME","CITY","STATE","CELL_PHONE","HOME_PHONE","NAME2","EMAIL","STATUS","END_RANK","COU"],DATA:{NAME:["ENTERPRISES SRL, SHANE MORAND"],CITY:["Santa Ana"],STATE:["SJ"],CELL_PHONE:["18888453990"],HOME_PHONE:["18888453990"],NAME2:[""],EMAIL:["info@shanemorand.com"],STATUS:["D"],END_RANK:["15"],COU:["CAN"]}};if(helper.checkNotNull(r)){let e=JSON.stringify(r),o=JSON.parse(e);if(console.log("parsedObj.COLUMNS: ",o.COLUMNS),!helper.checkNotNull(o.COLUMNS))return authForm.deleteToken(),void(helper.checkNotNull(o.DETAIL)?authForm.showMessage(o.DETAIL):authForm.showMessage("Invalid User Info"));{console.log("VALIDATED");let e=helper.getQueryString();e=authForm.redirectActivePage(),helper.checkNotNullString(e)||(e=constants.HOME_PAGE)}}authForm.hideLoader()},error:function(e,o,t){console.log("Error: ",e,o,t),helper.checkNotNull(e)&&401===e.status?$(".div-message").text("You are not authorized"):$(".div-message").text("Something went wrong. Unable to fetch data."),authForm.hideLoader()}})},showMessage:function(e){helper.checkNotNull(e)?($("div.message").html(e),$("div.message").removeClass("hidden"),authForm.hideLoader()):($("div.message").html(""),$("div.message").addClass("hidden"))},validate:function(){authForm.formReset();let e="",o=!0,t=$("input[name=idistributor]").val(),r=$("input[name=ipassword]").val();return helper.checkNotNullString(t)||(o=!1,e+="Distributor ID is required<br/>",$("input[name=idistributor]").parent().parent(".form-group").addClass("has-error")),helper.checkNotNullString(r)||(o=!1,e+="Password is required<br/>",$("input[name=ipassword]").parent().parent(".form-group").addClass("has-error")),authForm.showMessage(e),o},formReset:function(){$("input[name=idistributor]").parent().parent(".form-group").removeClass("has-error"),$("input[name=ipassword]").parent().parent(".form-group").removeClass("has-error"),authForm.showMessage()},formSet:function(){$("body").find("button[type=button]").click(function(){authForm.authenticate()}),$("body").find("button[type=reset]").click(function(){authForm.formReset()}),$("input[name=idistributor]").keypress(function(e){authForm.enterEvent(e)}),$("input[name=ipassword]").keypress(function(e){authForm.enterEvent(e)}),cookie.setCookie(constants.API_KEY,cookie.EncodeString("O3962162"),cookie.addHours(cookie.today(),12)),cookie.setCookie(constants.DIST_ID,cookie.EncodeString("1000101"),cookie.addHours(cookie.today(),12)),authForm.checkAuth()},showLoader:function(){$("body").find("button[type=button]").addClass("disabled"),$("body").find("input[name=idistributor]").addClass("disabled"),$("body").find("input[name=ipassword]").addClass("disabled"),$(".loading-results").removeClass("hide")},hideLoader:function(){$("body").find("button[type=button]").removeClass("disabled"),$("body").find("input[name=idistributor]").removeClass("disabled"),$("body").find("input[name=ipassword]").removeClass("disabled"),$(".loading-results").addClass("hide")},enterEvent:e=>{let o=e.which;if(13==o)return $("body").find("button[type=button]").click(),!1},api_key:()=>{let e=cookie.getCookie(constants.API_KEY);cookie.DecodeString(e)},dist_id:()=>{let e=cookie.getCookie(constants.DIST_ID);return cookie.DecodeString(e)},setToken:e=>{cookie.setCookie(constants.TOKEN,e,cookie.addDays(cookie.today(),30))},getToken:()=>cookie.getCookie(constants.TOKEN),deleteToken:()=>{cookie.deleteCookie(constants.TOKEN)},redirectActivePage:()=>cookie.getCookie(constants.LAST_ACTIVE_PAGE)};